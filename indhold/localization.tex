\section{Lokalisering}
Når robotten skal kortlægge sine omgivelser er det nødvendigt at vide hvor den befinder sig.
Til at finde positionen har vi overvejet flere forskellige metoder.
\begin{itemize}
\item Kinect
\item Dead reckoning
\item Kamera ansigtsgenkendelse \thilemann{Er det ikke mere blob genkendelse via OpenCV der menes?}
\end{itemize}

\subsection{Kinect }
Microsofts Kinect benytter et rgb kamera samt en dybdesensor til at fortolke bevægelse som input i applikationer.
Kinect er oprindeligt lavet til XBox 360, men findes også i en version til PC, med medfølgende SDK.
En stor fordel ved at bruge Kinect er at den indeholder en dybdesensor der kan bruges til at lokalisere objekter i et rum.


\subsection{Wiimote}
En anden sensor der kan bruges er Nintendos Wiimote. 
Wiimote en optisk sensor til at lokalisere infrarødt lys fra den tilhørende sensor bar.
Ved hjælp af triangulering af det modtagne lys kan wiimoten bestemme sin position. \cite{wiimote}

\subsection{Dead reckoning}
Dead Reckoning er en teknik til at finde sin position efter ens bevægelser uden eksterne sensorer.
Robotten ved hvor den starter, og beregner sin nye position efter hvilken kommando den har udført.\cite{deadrec}

Denne teknik er ikke det bedste valg i de situationer hvor man ønsker en meget præcis lokalisering af robotten, hvilket skyldes de usikkerheder for motorer og sensorer som man ofte arbejder med.

\subsection{Valg af lokaliseringsmetode}
Der blev foretaget en indledende test af de tre foreslåede lokaliseringsmetoder for at vælge hvilken der passede bedst til dette projekt.

Dead reckoning muligheden blev hurtigt udelukket, da gruppen ville fokusere på kortlægningsopgaven og dead reckoning ville kræve en del mere arbejde end de andre lokaliseringsmetoder.

Efter sammenligning af Kinect og Wiimote blev det besluttet at fokusere på Kinect af flere årsager.
For det første havde vi adgang til en Kinect hvilket gjorde valget oplagt. 
Også det medfølgende SDK gør det let at arbejde med.
\thilemann{Her mangler lidt, f.eks. "For det andet..."?}

\subsection{OpenCV}
Til at følge et objekt på det optagne billede har vi valgt at benytte et bibliotek kaldet ``OpenCV''.
OpenCV, eller Open Source Computer Vision Library er et bibliotek der indeholder algoritmer relateret til maskinintelligens, som f.eks. genkendelse af ansigter, identificering af objekter og forfølgelse af objekter.\cite{opencv}

OpenCV bruges i dette projekt til at følge de objekter der findes ved hjælp af Kinect sensoren.

\clearpage
\subsection{Omregning fra punkt i billede til reelt koordinat}
Det billede der fås ind fra kameraet, består af en mængde pixels.
Robottens centrum, og derved lokation, vil være i præcist én pixel.
For at robotten skal kunne bruge denne til at navigere i den virkelige verden, er det nødvendigt at omregne pixel(-koordinat) til reelt koordinat.

Den overordnede idé er at bruge reglen om ensvinklede trekanter, da det der gås ud fra, er situationen som kan ses i \cref{fig:kameratrekant}.
Her er $v$ den synsvinkel som kameraet har i den givne dimension; for Kinect'en er det $57^\circ$ i bredden og $43^\circ$ i højden.
$v$ er blot med for at vise at der er tale om ensvinklede trekanter.
$x_1$ er størrelse af den givne dimension for det billede der dannes af Kinect'en.
$x_2$ er tilsvarende $x_1$, blot den reelle størrelse af det billede der gives.

\begin{figure}[h]
\centering
\begin{tikzpicture}[extline/.style={shorten >=-#1,shorten <=-#1},
  extline/.default=1cm]

\coordinate (A) at (0,0);
\coordinate (B) at (2,6);
\coordinate (C) at (4,0);
\coordinate (A2) at (1,3);
\coordinate (C2) at (3,3);

\draw [dashed] (A) -- (B);
\draw [dashed] (B) -- (C);
\draw (A) -- (C) node [midway,below] {$x_2$};
\draw (A2) -- (C2) node [midway,below] {$x_1$};
\draw ($(B) + (-110:0.55)$) arc (-110:-70:0.55) node [right] {$v$};
\end{tikzpicture}
\caption{Situationen med alle de kendte variable}
\label{fig:kameratrekant}
\end{figure}

\subsubsection{Ensvinklede trekanter}
Hvis alle vinkler i to trekanter er parvis lige store, er siderne parvis proportionale.
Som det kan ses i \cref{fig:udregningstrekant} er der tale om netop sådan en trekant for vores situation.
Trekanten er halveret for at give den præcise midte koordinatet $0,0$, derved går en dimension fra $-\frac{1}{2}x$ til $+\frac{1}{2}x$.

For at finde proportionalitetsfaktoren deles en vilkårlig side af den store trekant med den tilsvarende side fra den lille trekant.
Her vil proportionalitetsfaktoren derved blive $f = \frac{\frac{1}{2}x_2}{\frac{1}{2}x_1}$.

For at omregne et pixel $p$ om til et reelt koordinat, skal der blot påregnes proportionalitetsfaktoren.
Så derved får vi vores koordinat $k = f \cdot p$.

\begin{figure}[h]
\centering
\begin{tikzpicture}[extline/.style={shorten >=-#1,shorten <=-#1},
  extline/.default=1cm]

\coordinate (A) at (0,0);
\coordinate (B) at (0,6);
\coordinate (C) at (2,0);
\coordinate (A2) at (0,3);
\coordinate (C2) at (1,3);
\coordinate (mAC) at (1.25,0);
\coordinate (oldA) at (-2,0);

\draw [dashed,color=gray] (oldA) -- (B);
\draw [dashed,color=gray] (oldA) -- (A);
\draw [thick,dotted] (mAC) -- (B);
\draw (A) -- (B);
\draw (B) -- (C);
\draw (A) -- (C) node [below,midway,xshift=-1cm] {$0$} node [below,midway,xshift=1.2cm] {$\frac{1}{2}x_2$};
\draw (A2) -- (C2) node [midway,xshift=1cm] {$\frac{1}{2}x_1$} node [midway,xshift=-0.7cm] {$0$};
\draw ($(B) + (-90:0.55)$) arc (-90:-70:0.55) node [right] {$\frac{1}{2}v$};
\filldraw (0.63,3) circle (0.05cm) node [left,yshift=-0.3cm] {$p$};
\filldraw (1.25,0) circle (0.05cm) node [left,yshift=-0.3cm] {$k$};
\end{tikzpicture}
\caption{Selve omregningen}
\label{fig:udregningstrekant}
\end{figure}