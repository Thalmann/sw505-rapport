\section{Kommunikationsprotokol}
Dette afsnit beskriver kommunikationen mellem NXT og PC.
Afsnitet beskriver de beskeder der bliver snedt frem og tilbage og hvilken encoding der bliver brugt.

\subsection{Besked typer}
En besked består af:
\begin{equation}
<Encoding><Indhold>
\end{equation}
og bliver sendt fra PC'ens outbox til NXT'ens inbox og vice versa.
Beskedens indhold er ingen eller flere bytes.
Alle beskederne kan ses i \cref{design:protokol_tabel}.
Første kolonne fortæller hvilken slags besked det er.
Anden og tredje kolonne fortæller henholdsvis om det er PC'ens eller NXT'ens inbox eller outbox.
Den sidste beskriver hvad der sker hvis man sender en besked med en sådan encoding.
Nedenefor er de forskellige scenarier som beskederne fra tabellen bliver brugt.

\begin{figure}[H]
\begin{longtable}{ c | c | c | p{0.6\textwidth}}
Encoding & PC & NXT & Indhold\\
\hline
\hline
0 & IN & OUT & Robotten forespørger om dens lokation \\
1 & IN & OUT & Robotten er nået frem til dens lokation \\
2 & IN & OUT & Robotten sender sensordata \\
50 & OUT & IN & Computeren fortæller roboten at den skal bevæge sig til en position som sendes med\\
51 & OUT & IN & Computeren beder om at få sensor data fra robotten \\
52 & OUT & IN & Computeren sender robottens position til robotten \\
\end{longtable}
\label{design:protokol_tabel}
\caption{Overigt over de forskellige encodings og hvilke beskeder de indeholder.}
\end{figure}

\subsubsection{Nuværende lokation}
Denne situation forekommer når robotten skal bede om sin lokation fra PC'en.
Dvs. robotten sender en besked der kun indeholder encodingen $0$.
Derefter returner PC'en beskeden $52xyz$.
Denne besked indeholder lokationen og dens vinkel hvor $x$ og $y$ repræsenterer lokationen og $z$ vinkelen.

\subsubsection{Naviger til en ny lokation}\label{design:protokol_navigertilny}
Denne situation opstår når PC'en sender en besked der fortæller robotten hvor den skal køre hen.
PC'ens besked har encoding $50xy$ hvor $50$ fortæller robotten at den nu modtager en lokation den skal navigere hen til.
Det resterende er lokationen $x,y$.

\subsubsection{Nået frem til lokation}
Denne situation forekommer når robotten er nået frem til den ønskede lokation.
Så sender robotten en besked der kun indeholder encodingen $1$.
Derefter sender PC'en til en ny lokation se i \cref{design:protokol_navigertilny}.

\subsubsection{Aflæs Sensordata}
Når PC'en beder om sensor data fra robotten, sender den en besked der kun indeholder $51$.
Robotten foretager derefter snesormålinger og returnerer dem.
Robottens besked til pc'en indeholder encoding og sensordata, $2s1s2s3s4$.
Sensordata'erne består af en måling fra hver sensor før sensorerne roterer 90 grader og efter.