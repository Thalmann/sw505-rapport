\section{System arkitektur}\label{arkitektur}
Til dette projekt er det besluttet at bygge systemet efter en lag-delt struktur.
Denne beslutning er taget for at for at overkomme kompleksiteten af systemet; altså, for at give hvert gruppemedlem bedre overblik over koden, men også for at skabe nogle generelle retningslinjer for placering at dets komponenter.

I de efterfølgende afsnit, vil arkitekturen (som ses på  \cref{arkitektur:klassediagram:1,arkitektur:klassediagram:2}) blive beskrevet.
Beskrivelsen vil fokusere på hvad de enkelte lag (namespaces) har til formål samt hvordan lagene interagerer med hinanden.
Som det også ses på figurene, er det kun de ydre associationer der er angivet for at simplificere beskrivelsen af systemet.
Som det første beskrives \textbf{CommonLib.dll} i \cref{arkitektur:commonlib}, da systemets lag alle holder referencer hertil.
Efterfølgende vil lagene blive beskrevet i en rækkefølge der følger kaldene internt i systemet.

\thilemann{Overvej om de to figurer bliver for utydelige - skal de sættes op anerledes?}
\begin{figure}
\centering
\includegraphics[width=1\textwidth]{./graphics/systemarkitektur_1}
\caption{Lagene i systemarkitekturen med deres ydre associationer. Associationerne til højre fører alle til \textbf{CommonLib.dll}, som ses på \cref{arkitektur:klassediagram:2}.}
\label{arkitektur:klassediagram:1}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=1\textwidth]{./graphics/systemarkitektur_2}
\caption{Viser namespacet \textbf{CommonLib.dll} (uden interne associationer) som er en del af den lagdelte systemarkitektur. De fleste lag i arkitekturen har associationer til netop \textbf{CommonLib.dll}, der indeholder de elementer som benyttes af alle lag. De refererende namespaces kan ses på \cref{arkitektur:klassediagram:1}.}
\label{arkitektur:klassediagram:2}
\end{figure}

\subsection{CommonLib.dll}\label{arkitektur:commonlib}
Benyttes af alle lag i arkitekturen.
Dets formål er at samle de komponenter som i systemet kan benyttes af alle lag.
Derfor holder det også en reference til namespacet \textbf{NKH.MindSqualls} for at kunne tilgå den del af MindSqualls (\cref{mindsqualls}) som indeholder kommunikationen til NXT-enheden.

\subsubsection{CommonLib.DTOs}
Dette namespace indeholder alle \textit{Data Transferring Objects} som har til opgave at sende data mellem de forskellige lag.

\subsubsection{CommonLib.NXTPostMan}
Som navnet på namespacet antyder, så er formålet med \textbf{CommonLib.NXTPostMan} at sende beskeder frem og tilbage mellem PC og robotten; hvilket gør det ansvarlig for al kommunikation imellem de to som der beskrives i detaljer i \cref{kommunikation}.

\subsubsection{CommonLib.Interfaces}
Definerer en række interfaces som implementeres af de respektive DTO'er.
Dette minimerer koblingen af koden og gør dem samtidig mere modulær, da komponenter nemt kan udskiftes.

\subsection{NKH.MindSqualls}\label{arkitektur:mindsqualls}
Dette er koden fra MindSqualls frameworket (beskrevet i \cref{mindsqualls}).
Det er dog ikke alle komponenter i frameworket der benyttes; det benyttes primært til at etablere kommunikation mellem NXT-enheden og PC samt exceptions, hvilket implementeres gennem \textit{PostMan} klassen.

\subsection{SystemInterface}\label{arkitektur:systeminterface}
Det er fra \textbf{SystemInterface} namespacet at 

\subsubsection{SystemInterface.GUI.exe}

\subsubsection{SystemInterface.RobotInterface}

\subsubsection{SystemInterface.ConsoleUI.exe}
\thilemann{Hvad med denne??}

\subsection{Control.dll}\label{arkitektur:control}
Denne komponent i arkitekturen er ansvarlig for kontrol af robotten samt opdatering af data.
Kald hertil stammer fra \textbf{SystemInterface} der anmoder om en action, som dette namespace så reagerer på ved at benytte \textbf{Services} namespacet.

\subsubsection{Control.DisplayControl}
Er en klasse som henter en videostrøm fra farvekameraet på en Microsoft Kinect.

\subsubsection{Control.LocationControl}
Denne klasse opdaterer lokationen af robotten.
Den indeholder således også information om robottens omgivelser og robotten selv; bl.a. en vector for robottens forreste lokation og ligeledes en for den bagerste samt hvilke farver der trackes på den.

\subsubsection{Control.MappingControl}
Al kontrol af robotten på kortet (occupancy grid) foregår gennem denne klasse.
Den indeholder således metoder til at sende robotten til et nyt koordinat, opdatere kortet og hente nye sensormålinger.

\subsection{Services.dll}\label{arkitektur:services}


\subsubsection{Services.RobotServices}

\subsubsection{Services.RouteService}

\subsubsection{Services.KinectServices}

\subsubsection{Services.TrackingServices}

\subsubsection{MindSqualls}
\thilemann{Bruges dette namespace stadig? Er det ikke blevet erstattet af PostMan?}

\subsection{Data.dll}\label{arkitektur:data}







